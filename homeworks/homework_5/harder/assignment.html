<!--?xml version="1.0" encoding="utf-8" ?-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml-transitional.dtd">
<html><head>
  <title>holoumar@progtest.fit.cvut.cz - ProgTest</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link href="assignment_files/css.css" rel="stylesheet" type="text/css">
  <script src="assignment_files/shared.js" language="JavaScript" type="text/javascript"></script>
  
 </head>
 <body text="#000000" bgcolor="#828273">
  <table width="100%" cellspacing="0" cellpadding="0" border="0">
   <tbody><tr height="25">
    <td bgcolor="#00ff00" align="left"><span class="navLink"><a class="navLink" href="https://progtest.fit.cvut.cz/index.php?X=Main">ProgTest</a>&nbsp;&nbsp;►&nbsp;&nbsp;<a class="navLink" href="https://progtest.fit.cvut.cz/index.php?X=Course&amp;Cou=103">BI-PA2 (13/14 LS)</a>&nbsp;&nbsp;►&nbsp;&nbsp;<a class="navLink" href="https://progtest.fit.cvut.cz/index.php?X=TaskGrp&amp;Cou=103&amp;Tgr=651">Domácí úloha 05</a>&nbsp;&nbsp;►&nbsp;&nbsp;<b>Indexování posloupností</b></span></td>
    <td bgcolor="#00ff00" align="right"><a class="navLink" href="https://progtest.fit.cvut.cz/index.php?X=Logout">Logout</a></td>
   </tr>
  </tbody></table>
<br>




 <br>
 <br>
   <center>
   <div class="topLayout">
    <div class="outBox">
     <table class="header" width="100%" cellspacing="0" cellpadding="0">
      <tbody><tr>
       <td class="header"><b>Indexování posloupností</b></td>
      </tr>
     </tbody></table>
    </div>
   </div>
  </center>
 <form name="form1" method="post" action="?X=TaskU&amp;Cou=103&amp;Tgr=651&amp;Tsk=1062" enctype="multipart/form-data">
  <center>
    <div class="topLayout">
     <div class="outBox">
      <table id="maintable" width="100%" cellspacing="0" cellpadding="2" border="0">
       <colgroup><col width="200">
       <col>
       <col width="130">

       </colgroup><tbody><tr>
        <td class="ltCell" align="left"><b>Termín odevzdání:</b></td>
        <td class="tCell" align="left"><b>27.04.2014 23:59:59</b></td>
        <td class="rtCell" id="countdown" align="right">&nbsp;</td>
       </tr>

       <tr>
        <td class="lCell" align="left"><b>Hodnocení:</b></td>
        <td class="rCell" colspan="2" align="left"><b>5.5000</b></td>
       </tr>
       <tr>
        <td class="lCell" align="left"><b>Max. hodnocení:</b></td>
        <td class="rCell" colspan="2" align="left"><b>5.0000</b> (bez bonusů)</td>
       </tr>
       <tr>
        <td class="lCell" align="left"><b>Odevzdaná řešení:</b></td>
        <td class="rCell" colspan="2" align="left">1 /  20 Volné pokusy + 20 Penalizované pokusy (-2 % penalizace za každé odevzdání)</td>
       </tr>

       <tr>
        <td class="lbCell" align="left"><b>Nápovědy:</b></td>
        <td class="rbCell" colspan="2" align="left">0 / 2 Volné nápovědy + 2 Penalizované nápovědy (-10 % penalizace za každou nápovědu)</td>
       </tr>

       <tr>
        <td class="lrtbCell" colspan="3" align="left"><p>Úkolem je vytvořit šablonu třídy, který bude implementovat generický index.</p>

<p>Implementovaná třída <tt>CIndex</tt> dostane při vytváření parametrem
kolekci s posloupností prvků.  Tuto posloupnost prvků bude indexovat. 
Posloupnost může být:</p>

<ul>
 <li><tt>string</tt> - řetězec znaků (C++ string prvků typu char),</li>
 <li><tt>vector&lt;T&gt;</tt> - vektorem hodnot (nějakého typu T),</li>
 <li><tt>list&lt;T&gt;</tt> - seznamem hodnot (nějakého typu T).</li>
</ul>

<p>Nad takto zaindexovanou posloupností chceme vyhledávat. Tedy zadáme 
nějakou posloupnost prvků (stejného typu) a chceme zjistit, zda ji 
indexovaná posloupnost někde obsahuje. Výsledkem bude množina pozic, 
kde je hledaná posloupnost nalezena.</p>

<p>Aby byla indexovací třída obecnější, je vylepšena ještě možností zadat 
vlastní porovnávač (nepovinný druhý generický parametr). Vyhledávání tedy 
nemusí probíhat na přesnou shodu, pomocí vlastního porovnávače můžeme zadat,
že při porovnávání např. nerozlišujeme malá a velká písmena. Porovnávač bude 
mít podobu jakou mají porovnávače v STL: bude se jednat o funkci, funktor nebo
C++11 lambda výraz, který pro dvojici prvků typu T v posloupnosti rozhodne, který je 
v požadovaném porovnání menší. Pokud porovnávač není zadán, použije pro 
porovnávání prvků operátor &lt; platný pro ukládané hodnoty prvků.</p>

<p>Vlastní prvky v posloupnostech (prvky typu T) mohou být libovolné. Příkladem je 
znak (char), celé číslo (int) nebo řetězec (string). Obecně víte, že pro typ T 
jsou definované následující operace:</p>

<ul>
 <li>kopírování (operátorem = a kopírujícím konstruktorem),</li>
 <li>porovnávání "menší než" operátorem &lt; nebo dodaným komparátorem,</li>
 <li>uvolňování (destruktor),</li>
 <li>další operace mohou, ale nemusí být s typem T dostupné, tedy Vaše implementace 
  se na ně obecně nemůže spolehnout. Pozor, nemusí být k dispozici implicitní konstruktor, 
  operátor ==, operátor !=, ...</li>
</ul>


<p>Rozhraní třídy je následující:</p>
<pre>#ifndef __PROGTEST__
#include &lt;cstring&gt;  
#include &lt;iostream&gt; 
#include &lt;iomanip&gt;  
#include &lt;set&gt;
#include &lt;list&gt;
#include &lt;vector&gt;
#include &lt;map&gt;   
#include &lt;algorithm&gt;
#include &lt;functional&gt;
using namespace std; 
#endif /* __PROGTEST__ */


template &lt;typename _Type, typename _Comparator = ...&gt;
class CIndex
 {
   public:
             CIndex ( const _Type &amp; sequenceToIndex,
                      const _Comparator &amp; comparator = _Comparator () );
            ~CIndex ( void );
    set&lt;int&gt; Search ( const _Type &amp; searchFor ) const;

   private:
    // todo
 };
</pre> 

<p>Odevzdávejte soubor, který obsahuje implementovanou šablonu třídy
<tt>CIndex</tt> a další Vaše podpůrné třídy. Třída musí splňovat veřejné
rozhraní podle ukázky - pokud Vámi odevzdané řešení nebude obsahovat popsané
rozhraní, dojde k chybě při kompilaci. Do třídy si ale můžete doplnit další metody
(veřejné nebo i privátní) a členské proměnné. Odevzdávaný soubor musí obsahovat   
jak deklaraci třídy (popis rozhraní) tak i definice metod, konstruktoru a
destruktoru. Je jedno, zda jsou metody implementované inline
nebo odděleně. Odevzdávaný soubor nesmí obsahovat vkládání hlavičkových
souborů a funkci <tt>main</tt>. Funkce <tt>main</tt> a vkládání hlavičkových souborů
může zůstat, ale pouze obalené direktivami podmíněného překladu jako v ukázce níže.</p>

<p>Při řešení úlohy využijte STL. Můžete využívat prvky C++11, upozorňuji ale, 
že používaný kompilátor má určité problémy při kompilování lambda výrazů, kde je zachycovaný 
<tt>this</tt>. Takovým lambda výrazům se doporučuji vyhnout a zachycovat <tt>this</tt> 
pomocí lokální proměnné nastavené na hodnotu this. </p>

<p>Úloha obsahuje povinné a bonusové testy. Základním testem projde řešení hledající 
výskyty naivním algoritmem. Pro získání bonusů je potřeba implementovat algoritmy 
efektivnější. Při návrhu můžete předpokládat:</p>

<ul>
 <li>Jednou zaindexovaná posloupnost je prohledávaná vícekrát. Je tedy rozumné 
  věnovat čas předzpracování, kterým se zkrátí vlastní vyhledávání. Můžete počítat s tím,
  že metoda <tt>Search</tt> je volaná v průměru 100x na jednu instanci.</li>

 <li>Obecná implementace s generickým typem prvku a s obecným komparátorem se 
  testuje v povinných testech. Testy rychlosti pracují s datovým typem <tt>string</tt> 
  a používají implicitní komparátor. Částečná specializace šablony třídy pro takto omezené
  vstupy může výrazně zrychlit výpočet.</li>

 <li>Pro zrychlení vyhledávání se hodí algoritmus KMP, pro indexaci se dá využít 
  suffixové pole nebo DAWG.</li>
</ul>

<p>Ukázka práce třídy:</p>

<pre>class CStrComparator
 {
   public:
                   CStrComparator ( bool caseSensitive )
                    : m_CaseSensitive ( caseSensitive ) { }
    bool           operator () ( const string &amp; a, const string &amp; b ) const
     {
       return m_CaseSensitive ? strcasecmp ( a . c_str (), b . c_str () ) &lt; 0 : a &lt; b ;
     }
    bool           m_CaseSensitive;
 };

bool upperCaseCompare ( const char &amp; a, const char &amp; b )
 {
   return toupper ( a ) &lt; toupper ( b );
 }

...

CIndex &lt;string&gt; t0 ( "abcabcabc" );
set&lt;int&gt; r0 = t0 . Search ( "a" );
 // 0 3 6
set&lt;int&gt; r1 = t0 . Search ( "abc" );
 // 0 3 6
set&lt;int&gt; r2 = t0 . Search ( "abcabc" );
 // 0 3

CIndex &lt;string&gt; t1 ( "abcababc" );
set&lt;int&gt; r3 = t1 . Search ( "a" );
 // 0 3 5
set&lt;int&gt; r4 = t1 . Search ( "abc" );
 // 0 5
set&lt;int&gt; r5 = t1 . Search ( "abcabc" );
 //

CIndex &lt;string&gt; t2 ( "kokokokoskokosokos" );
set&lt;int&gt; r6 = t2 . Search ( "kos" );
 // 6 11 15
set&lt;int&gt; r7 = t2 . Search ( "kokos" );
 // 4 9

CIndex &lt;string&gt; t3 ( "aaaaaaau aaauaaaau" );
set&lt;int&gt; r8 = t3 . Search ( "aa" );
 // 0 1 2 3 4 5 9 10 13 14 15
set&lt;int&gt; r9 = t3 . Search ( "aaa" );
 // 0 1 2 3 4 9 13 14
set&lt;int&gt; r10 = t3 . Search ( "aaaa" );
 // 0 1 2 3 13

CIndex &lt;string&gt; t4 ( "automatIc authentication automotive auTOmation raut" );
set&lt;int&gt; r11 = t4 . Search ( "auto" );
 // 0 25
set&lt;int&gt; r12 = t4 . Search ( "aut" );
 // 0 10 25 48
set&lt;int&gt; r13 = t4 . Search ( "tic" );
 // 16
set&lt;int&gt; r14 = t4 . Search ( "trunk" );
 //
set&lt;int&gt; r15 = t4 . Search ( "a" );
 // 0 5 10 19 25 36 41 48
set&lt;int&gt; r16 = t4 . Search ( "" );
 // 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 
 // 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50

CIndex &lt;string, bool(*)(const char &amp;, const char &amp; )&gt; t5 ( "automatIc authentication automotive auTOmation raut", upperCaseCompare );
set&lt;int&gt; r17 = t5 . Search ( "auto" );
 // 0 25 36
set&lt;int&gt; r18 = t5 . Search ( "aut" );
 // 0 10 25 36 48
set&lt;int&gt; r19 = t5 . Search ( "tic" );
 // 6 16
set&lt;int&gt; r20 = t5 . Search ( "trunk" );
 //
set&lt;int&gt; r21 = t5 . Search ( "a" );
 // 0 5 10 19 25 36 41 48
set&lt;int&gt; r22 = t5 . Search ( "" );
 // 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 
 // 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50

CIndex &lt;list&lt;string&gt;, CStrComparator&gt; t6 ( list&lt;string&gt;{ "Hello", "world", "test", "this", "foo", "TEsT", "this", "done" }, CStrComparator ( false ) );
set&lt;int&gt; r23 = t6 . Search ( list&lt;string&gt;{"test", "this", "foo"} );
 // 2
set&lt;int&gt; r24 = t6 . Search ( list&lt;string&gt;{"test", "this"} );
 // 2

CIndex &lt;list&lt;string&gt;, CStrComparator&gt; t7 ( list&lt;string&gt;{ "Hello", "world", "test", "this", "foo", "TEsT", "this", "done" }, CStrComparator ( true ) );
set&lt;int&gt; r25 = t7 . Search ( list&lt;string&gt;{"test", "this", "foo"} );
 // 2
set&lt;int&gt; r26 = t7 . Search ( list&lt;string&gt;{"test", "this"} );
 // 2 5
</pre>
</td>
       </tr>












      </tbody></table>
     </div>
    </div>


 <br>
 <div class="topLayout">
  <div class="outBox">
   <table id="reftable" width="100%" cellspacing="0" cellpadding="2" border="0">
   <tbody><tr>
    <td class="ltbSepCell" align="left"><input name="SHOW_REF" onchange="showRefSolution()" type="checkbox">&nbsp;<b>Referenční řešení</b></td>
    <td class="rtbSepCell" align="right">&nbsp;</td>
   </tr>
   <tr style="display: none;">
    <td class="lrtbCell" colspan="2" align="left"><ul><li><b>Hodnotitel: automat</b><ul><li>Program zkompilován</li><li>Test 'Zakladni test s parametry podle ukazky': Úspěch<ul><li>Dosaženo: 100.00 %, požadováno: 100.00 %</li><li>Celková doba běhu: 0.001 s (limit: 10.000 s)</li><li>Využití paměti: 12948 KiB (limit: 24103 KiB)</li><li>Úspěch v závazném testu, hodnocení: 100.00 %</li></ul></li>
<li>Test 'Test nahodnymi daty': Úspěch<ul><li>Dosaženo: 100.00 %, požadováno: 50.00 %</li><li>Celková doba běhu: 0.543 s (limit: 9.999 s)</li><li>Využití paměti: 13072 KiB (limit: 24103 KiB)</li><li>Úspěch v závazném testu, hodnocení: 100.00 %</li></ul></li>
<li>Test 'Rychlost #1': Úspěch<ul><li>Dosaženo: 100.00 %, požadováno: 100.00 %</li><li>Celková doba běhu: 2.349 s (limit: 10.000 s)</li><li>Využití paměti: 13656 KiB (limit: 113947 KiB)</li><li>Úspěch v bonusovém testu, hodnocení: 120.00 %</li></ul></li>
<li>Test 'Rychlost #2': Úspěch<ul><li>Dosaženo: 100.00 %, požadováno: 100.00 %</li><li>Celková doba běhu: 0.265 s (limit: 10.000 s)</li><li>Využití paměti: 16196 KiB (limit: 113947 KiB)</li><li>Úspěch v bonusovém testu, hodnocení: 120.00 %</li></ul></li>
<li>Celkové hodnocení: 144.00 % (= 1.00 * 1.00 * 1.20 * 1.20)</li></ul></li><li>Celkové procentní hodnocení: 144.00 %</li><li>Bonus za včasné odevzdání: 0.50</li><li>Celkem bodů: 1.44 * ( 5.00 + 0.50 ) = 7.92</li></ul></td>
   </tr>
    <tr style="display: none;">
  <td class="ltbCell" align="left"><b>SW metriky:</b></td>
  <td class="rtbCell" colspan="2" align="left">
   <table cellpadding="2" border="0">
    <tbody><tr>
     <td>&nbsp;</td>
     <td class="ac">Celkem</td>
     <td class="ac">Průměr</td>
     <td class="ac">Maximum</td>
     <td>Jméno funkce</td>
    </tr>
    <tr>
     <td>Funkce:</td>
     <td class="ar"><b>2</b></td>
     <td class="ar">--</td>
     <td class="ar">--</td>
     <td>--</td>
    </tr>
    <tr>
     <td>Řádek kódu:</td>
     <td class="ar"><b>28</b></td>
     <td class="ar"><span class="textOk">14.00 ± 8.00</span></td>
     <td class="ar"><span class="textOk">22</span></td>
     <td><tt>Search(const _Type &amp;)</tt></td>
    </tr>
    <tr>
     <td>Cyklomatická složitost:</td>
     <td class="ar"><b>9</b></td>
     <td class="ar"><span class="textOk">4.50 ± 4.50</span></td>
     <td class="ar"><span class="textOk">9</span></td>
     <td><tt>Search(const _Type &amp;)</tt></td>
    </tr>
   </tbody></table>
  </td>
 </tr>
   </tbody></table>
  </div>
 </div>




 <br>
 <div class="topLayout">
  <div class="outBox">
   <table id="maintable" width="100%" cellspacing="0" cellpadding="2" border="0">
    <colgroup><col width="200">
    <col>
    <col width="130">

   </colgroup><tbody><tr>
    <td class="ltbOkSepCell" align="left"><b>1</b></td>
    <td class="tbOkSepCell" align="left"><b>12.04.2014 19:36:59</b></td>
    <td class="rtbOkSepCell" align="center"><div class="but1 w120"><div class="but2"><a class="butLink" href="https://progtest.fit.cvut.cz/index.php?X=TaskD&amp;Cou=103&amp;Tgr=651&amp;Tsk=1062&amp;Sub=442432">Download</a></div></div></td>
   </tr>
   <tr>
    <td class="ltCell" align="left"><b>Stav odevzdání:</b></td>
    <td class="tCell" align="left">Ohodnoceno</td>



    <td class="rtbCell" rowspan="2">&nbsp;</td>


   </tr>

   <tr>
    <td class="lbCell" align="left"><b>Hodnocení:</b></td>
    <td class="bCell" align="left">5.5000</td>
   </tr>   <tr>
    <td class="lrtbCell" colspan="3" align="left"><ul><li><b>Hodnotitel: automat</b><ul><li>Program zkompilován</li><li>Test 'Zakladni test s parametry podle ukazky': Úspěch<ul><li>Dosaženo: 100.00 %, požadováno: 100.00 %</li><li>Celková doba běhu: 0.001 s (limit: 10.000 s)</li><li>Využití paměti: 12864 KiB (limit: 24103 KiB)</li><li>Úspěch v závazném testu, hodnocení: 100.00 %</li></ul></li>
<li>Test 'Test nahodnymi daty': Úspěch<ul><li>Dosaženo: 100.00 %, požadováno: 50.00 %</li><li>Celková doba běhu: 3.124 s (limit: 9.999 s)</li><li>Využití paměti: 12864 KiB (limit: 24103 KiB)</li><li>Úspěch v závazném testu, hodnocení: 100.00 %</li></ul></li>
<li>Test 'Rychlost #1': Program překročil přidělenou maximální dobu běhu<ul><li>Vyčerpání limitu na celý test, program násilně ukončen po: 10.004 s (limit: 10.000 s)</li><li>Neúspěch v bonusovém testu, hodnocení: Bonus nebude udělen</li></ul></li>
<li>Celkové hodnocení: 100.00 % (= 1.00 * 1.00)</li></ul></li><li>Celkové procentní hodnocení: 100.00 %</li><li>Bonus za včasné odevzdání: 0.50</li><li>Celkem bodů: 1.00 * ( 5.00 + 0.50 ) = 5.50</li></ul></td>
   </tr> <tr>
  <td class="ltbCell" align="left"><b>SW metriky:</b></td>
  <td class="rtbCell" colspan="2" align="left">
   <table cellpadding="2" border="0">
    <tbody><tr>
     <td>&nbsp;</td>
     <td class="ac">Celkem</td>
     <td class="ac">Průměr</td>
     <td class="ac">Maximum</td>
     <td>Jméno funkce</td>
    </tr>
    <tr>
     <td>Funkce:</td>
     <td class="ar"><b>4</b></td>
     <td class="ar">--</td>
     <td class="ar">--</td>
     <td>--</td>
    </tr>
    <tr>
     <td>Řádek kódu:</td>
     <td class="ar"><b>56</b></td>
     <td class="ar"><span class="textOk">14.00 ± 19.66</span></td>
     <td class="ar"><span class="textOk">48</span></td>
     <td><tt>Search(const T &amp;)</tt></td>
    </tr>
    <tr>
     <td>Cyklomatická složitost:</td>
     <td class="ar"><b>15</b></td>
     <td class="ar"><span class="textOk">3.75 ± 6.50</span></td>
     <td class="ar"><span class="textOk">15</span></td>
     <td><tt>Search(const T &amp;)</tt></td>
    </tr>
   </tbody></table>
  </td>
 </tr>   </tbody></table>
  </div>
 </div>
  </center>
 </form>








<script language="javascript" type="text/javascript">
<!--

var deadLine = new Date ( 1398635999 * 1000 );

function CBpressed ( num )
 {
   var pre, cb;

   cb = MM_findObj ( "cb_" + num );
   pre = MM_findObj ( "pre_" + num );
   if ( cb != null && pre != null )
    {
      pre . style . display = cb . checked ? "block" : "none";
    }
 }

function unlockAdvice ( url )
 {
   if ( confirm ( 'Máte k dispozici pouze omezený počet nápověd. Navíc, použití nápovědy může snížit bodové hodnocení. Opravdu chcete zpřístupnit tuto nápovědu?' ) )
    this . location = url;
 }

function setCountdown ( )
 {
   var d = new Date ();
   var x = ( deadLine . getTime () - d . getTime () );
   var tgt = document . getElementById ( "countdown" );

   if ( x > 0 )
    {
      var s = Math . floor ( x / 1000 );
      var ms = (x % 1000) + "";

      while ( ms . length  < 3 ) ms = "0" + ms;

      tgt . innerHTML = s + "." + ms + " sec";

      window . setTimeout ( setCountdown, 117 );
    }
   else
    {
      tgt . innerHTML = '&nbsp;';
    }
 }

function showRefSolution ( )
 {
   var t = document . getElementById ( "reftable" );
   var x = document . getElementsByName ( "SHOW_REF" )[0];

   if ( ! x ) return;
   var r1 = t . rows[1], r2 = t . rows[2];

   if ( x . checked )
    {
      r1 . style . display = "";
      if ( r2 ) r2 . style . display = "";
    }
   else
    {
      r1 . style . display = "none";
      if ( r2 ) r2 . style . display = "none";
    }
 }


setCountdown ();
showRefSolution ();

// -->
</script>





 


</body></html>
<!-- Template run time: 0.061115026473999 sec -->